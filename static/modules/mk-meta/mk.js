;
//#../static/modules/mk-meta/index.js
var MetaLoader=function(e,t){var n=Rest.create(e),r={loadList:function(n){r.page=n||r.page||"0",$.ajax({url:"/mkmeta/list/"+e,data:{page:r.page},success:function(e){t.html(e),r.bindAction()}})},bindAction:function(){t.find("a.delete").click(function(){var e=$(this).attr("id");confirm("确定要删除此案例吗？")&&n.remove({id:e},function(e){$.tip(e.message),e.code>0&&r.loadList()})}),t.find("a.edit").click(function(){var e=$(this).attr("id");r.loadMetaEdit(e)}),t.find("button#addcase").click(function(){r.loadMetaEdit()}),t.find(".pager-bar").pager(function(e){r.loadList(e)})},loadMetaEdit:function(t){$.ajax({url:"/mkmeta/editform/"+e,data:{id:t},success:function(e){var t=$("<div id='editwrapper' class='dialog-wrapper'></div>");t.appendTo(document.body),t.html(e),r.bindEditAction(t)}})},bindEditAction:function(e){e.find("button.close").click(function(){e.remove()}),e.find("#image-upload").bindUpload({url:"/mkimg/upload",accept:"image/*",params:{upload_dir:"metaimg"},oncomplate:function(t){var n=e.find("#image-upload").parent().parent();n.find(".up-img").attr("src",t.url).show(),n.find("input.up-url").val(t.url)}}),e.find("button#metasave").click(function(){var t=e.find("#metaform").serializeJson();t.isuse=="on"?t.isuse="1":t.isuse="0",t.istop=="on"?t.istop="1":t.istop="0";if(t.id){var i=t.id;delete t.id,n.update({id:i},t,function(t){$.tip(t.message),t.code>0&&(e.remove(),r.loadList())})}else n.add(t,function(t){$.tip(t.message),t.code>0&&(e.remove(),r.loadList())})})}};return r};
//#../static/modules/mk-rest/js/rest.js
var Rest=window.Rest||{};Rest.create=function(e){return{add:function(t,n){$.ajax({url:"/add/"+e,data:t,type:"post",success:n})},query:function(t,n){$.ajax({url:"/query/"+e,data:t,type:"get",success:n})},get:function(t,n){$.ajax({url:"/get/"+e+"/"+t,type:"get",success:n})},update:function(t,n,r){$.ajax({url:"/update/"+e+"?"+$.param(t),type:"post",data:n,success:r})},remove:function(t,n){$.ajax({url:"/remove/"+e,type:"get",data:t,success:n})},action:function(t,n,r){$.ajax({url:"/action/"+e+"/"+t,type:"post",data:n,success:r})}}};
